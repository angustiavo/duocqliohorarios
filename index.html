<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Mi Planificador de Horario</title>
  <style>
    body { font-family: 'Segoe UI', Arial, sans-serif; margin: 10px; background-color: #f0f2f5; font-size: 14px; color: #333; }
    h2 { color: #1a3a5a; border-bottom: 2px solid #1a3a5a; padding-bottom: 10px; margin-top: 5px; }
    .controles { display: grid; grid-template-columns: 1fr; gap: 10px; background: #fff; padding: 15px; border-radius: 8px; margin-bottom: 15px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
    label { font-weight: bold; font-size: 13px; display: block; margin-bottom: 5px; color: #1a3a5a; }
    select { width: 100%; padding: 10px; border-radius: 5px; border: 1px solid #ccc; font-size: 14px; background-color: #fafafa; }
    
    /* Estilo para los checkboxes de los optativos */
    .optativos-container { background: #f8f9fa; padding: 10px; border-radius: 5px; border: 1px solid #ddd; margin-top: 5px; }
    .opt-item { display: flex; align-items: center; padding: 8px 0; border-bottom: 1px solid #eee; }
    .opt-item:last-child { border-bottom: none; }
    .opt-item input { margin-right: 10px; width: 20px; height: 20px; cursor: pointer; }
    .opt-text { font-size: 12px; cursor: pointer; flex: 1; }

    .btn-limpiar { background-color: #dc3545; color: white; border: none; padding: 12px; border-radius: 5px; width: 100%; font-weight: bold; margin-bottom: 15px; cursor: pointer; }
    .table-wrapper { overflow-x: auto; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
    table { border-collapse: collapse; width: 100%; background: white; min-width: 750px; }
    th, td { border: 1px solid #ddd; padding: 8px; text-align: center; font-size: 11px; height: 42px; }
    th { background-color: #1a3a5a; color: white; text-transform: uppercase; }
    td:first-child { font-weight: bold; background-color: #f8f9fa; width: 110px; color: #555; }
    .bloque { background-color: #e3f2fd; font-weight: bold; color: #0d47a1; border: 1px solid #90caf9; }
    .conflicto { background-color: #ffcdd2; color: #b71c1c; border: 2px solid #ef5350; font-weight: bold; }
    #alerta { color: #b71c1c; background: #ffcdd2; padding: 12px; border-radius: 5px; margin-bottom: 15px; display: none; font-size: 13px; font-weight: bold; border-left: 5px solid #b71c1c; }
  </style>
</head>
<body>

<h2>üìÖ Mi Planificador de Horario</h2>
<button class="btn-limpiar" onclick="limpiarTodo()">üßπ Limpiar Todo</button>
<div id="alerta"></div>

<div class="controles">
  <div>
    <label>üçΩÔ∏è Cocina Criolla Chilena (PGG1110)</label>
    <select id="cocina" onchange="actualizar()">
      <option value="">-- Seleccionar Secci√≥n --</option>
      <option value="Lu-1-6:COCINA">001D ‚Äì Ver√≥nica Montserrat Santamar√≠a (Lu 08:31-12:50)</option>
      <option value="Lu-8-13:COCINA">002D ‚Äì Mar√≠a Sylvia Tapia (Lu 13:41-18:10)</option>
      <option value="Ma-1-6:COCINA">003D ‚Äì Por Confirmar (Ma 08:31-12:50)</option>
      <option value="Ju-1-6:COCINA">004D ‚Äì Patricio Andr√©s Barrera (Ju 08:31-12:50)</option>
    </select>
  </div>

  <div>
    <label>üç∞ Pasteler√≠a Criolla (PGG1111)</label>
    <select id="pasteleria" onchange="actualizar()">
      <option value="">-- Seleccionar Secci√≥n --</option>
      <option value="Ma-1-6:PASTELER√çA">001D ‚Äì Patricio Andr√©s Barrera (Ma 08:31-12:50)</option>
      <option value="Ma-8-13:PASTELER√çA">002D ‚Äì Katherine Alejandra Mu√±oz (Ma 13:41-18:10)</option>
      <option value="Mi-1-6:PASTELER√çA">003D ‚Äì Katherine Alejandra Mu√±oz (Mi 08:31-12:50)</option>
    </select>
  </div>

  <div>
    <label>üß™ Gastronom√≠a Cient√≠fica (DPG1105)</label>
    <select id="ciencia" onchange="actualizar()">
      <option value="">-- Seleccionar Secci√≥n --</option>
      <option value="Mi-1-3:CIENCIA">001D ‚Äì Oscar Armando Carrasco (Mi 08:31-10:40)</option>
      <option value="Mi-4-6:CIENCIA">002D ‚Äì Romina del Carmen D√≠az (Mi 10:41-12:50)</option>
    </select>
  </div>

  <div>
    <label>üç∑ Vinos y Mixolog√≠a (PGG1112)</label>
    <select id="vinos" onchange="actualizar()">
      <option value="">-- Seleccionar Secci√≥n --</option>
      <option value="Mi-1-5:VINOS">001D ‚Äì Paola Mylene Michaud (Mi 08:31-12:10)</option>
      <option value="Mi-8-12:VINOS">002D ‚Äì Francisco Javier Tiska (Mi 13:41-17:20)</option>
    </select>
  </div>

  <div>
    <label>üó£Ô∏è Ingl√©s Elemental I (INU3101)</label>
    <select id="ingles" onchange="actualizar()">
      <option value="">-- Seleccionar Secci√≥n --</option>
      <option value="Mi-7-8:INGL√âS (ON)|Vi-8-9:INGL√âS (ON)">001D ‚Äì Marcela Cornejo (Online S√≠ncrona)</option>
      <option value="Ma-13-14:INGL√âS (ON)|Ju-13-14:INGL√âS (ON)">002D ‚Äì Carlos Bravo (Online S√≠ncrona)</option>
      <option value="Ma-5-6:INGL√âS|Mi-6-7:INGL√âS">003D ‚Äì Blanca Rosa Fierro (Presencial)</option>
      <option value="Mi-1-2:INGL√âS|Vi-6-7:INGL√âS">004D ‚Äì Sof√≠a Catalina Ilabaca (Presencial)</option>
    </select>
  </div>

  <div>
    <label>üè´ Optativos (Puedes marcar varios)</label>
    <div class="optativos-container" id="optativos-checks">
      <div class="opt-item">
        <input type="checkbox" value="Ju-1-4:MARCA" onchange="actualizar()">
        <span class="opt-text">Gesti√≥n de Marca Personal (Ju 08:31-11:20)</span>
      </div>
      <div class="opt-item">
        <input type="checkbox" value="Vi-1-5:CULTURA" onchange="actualizar()">
        <span class="opt-text">Cultura y Gastronom√≠a (Vi 08:31-12:10)</span>
      </div>
      <div class="opt-item">
        <input type="checkbox" value="0-0:ALFABETIZACION" onchange="actualizar()">
        <span class="opt-text">Alfabetizaci√≥n Informacional (Por Confirmar)</span>
      </div>
    </div>
  </div>
</div>

<div class="table-wrapper">
  <table>
    <thead>
      <tr><th>Horario</th><th>Lunes</th><th>Martes</th><th>Mi√©rcoles</th><th>Jueves</th><th>Viernes</th></tr>
    </thead>
    <tbody id="tabla"></tbody>
  </table>
</div>

<script>
const rangos = [
  "08:31‚Äì09:10", "09:11‚Äì09:50", "10:01‚Äì10:40", "10:41‚Äì11:20",
  "11:31‚Äì12:10", "12:11‚Äì12:50", "13:01‚Äì13:40", "13:41‚Äì14:20",
  "14:31‚Äì15:10", "15:11‚Äì15:50", "16:01‚Äì16:40", "16:41‚Äì17:20",
  "17:31‚Äì18:10", "18:11‚Äì18:50"
];
const dias = ["Lu","Ma","Mi","Ju","Vi"];
const tabla = document.getElementById("tabla");
const alerta = document.getElementById("alerta");
let ocupado = {};

// Dibujar tabla
rangos.forEach((hora, i) => {
  const fila = document.createElement("tr");
  fila.innerHTML = `<td>${hora}</td>` + dias.map(d => `<td data-dia="${d}" data-modulo="${i+1}"></td>`).join("");
  tabla.appendChild(fila);
});

function pintar(valor) {
  if (!valor) return;
  valor.split("|").forEach(v => {
    const [bloque, nombre] = v.split(":");
    const [dia, desde, hasta] = bloque.split("-");
    for (let i = parseInt(desde); i <= parseInt(hasta); i++) {
      const clave = dia + "-" + i;
      const celda = document.querySelector(`td[data-dia="${dia}"][data-modulo="${i}"]`);
      if (celda) {
        if (ocupado[clave]) {
          celda.classList.add("conflicto");
          alerta.style.display = "block";
          alerta.innerHTML += `‚ö†Ô∏è Tope: ${nombre} choca con ${ocupado[clave]} (${dia} ${rangos[i-1]})<br>`;
        } else {
          celda.classList.add("bloque");
          celda.textContent = nombre;
          ocupado[clave] = nombre;
        }
      }
    }
  });
}

function actualizar() {
  document.querySelectorAll("td[data-dia]").forEach(c => { c.textContent = ""; c.className = ""; });
  ocupado = {}; alerta.innerHTML = ""; alerta.style.display = "none";
  
  // Ramos obligatorios
  ["cocina", "pasteleria", "ciencia", "vinos", "ingles"].forEach(id => {
    const s = document.getElementById(id);
    if (s && s.value) pintar(s.value);
  });

  // Optativos (Checkboxes)
  document.querySelectorAll('#optativos-checks input:checked').forEach(cb => {
    pintar(cb.value);
  });
}

function limpiarTodo() {
  document.querySelectorAll('select').forEach(s => s.value = '');
  document.querySelectorAll('input[type="checkbox"]').forEach(cb => cb.checked = false);
  actualizar();
}
</script>
</body>
</html>
